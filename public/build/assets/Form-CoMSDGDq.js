import{r as y,C as A,c as k,o as F,a as U,b as s,d as B,e as D,f as a,u as i,m as P,w as l,g as u,h as R,i as V,v as I,j as K,F as M}from"./app-CCubCURJ.js";import{_ as N}from"./AuthenticatedLayout-B9F9J7p2.js";import"./ApplicationStore-0Ra5hPV3.js";import"./AppMessageListener-BV5kQA_v.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"py-12"},O={class:"mx-auto max-w-[90%]"},S={class:"flex justify-end"},Q={__name:"Form",props:{article_categories:Array,article:Object},setup(b){var p,f,g,_;const n=b,m=y(null),c=y(null),r=A({image:(p=n.article)!=null&&p.image?{url:"/storage/"+n.article.image,name:n.article.image.split("/").pop(),type:"/image/.*/",status:"finished"}:null,article_category_id:((f=n.article)==null?void 0:f.article_category_id)??null,title:((g=n.article)==null?void 0:g.title)??"",content:((_=n.article)==null?void 0:_.content)??""}),h=k(()=>{var t;return((t=n.article_categories)==null?void 0:t.map(e=>({label:e.name,value:e.id})))||[]}),x={image:{trigger:["input","blur","change"],required:!0,validator(t,e){return e?/image\/.*/.test(e.type)?Promise.resolve():Promise.reject(new Error("File type must be an image")):Promise.reject(new Error("Image is required"))}},article_category_id:{trigger:["change","blur","input"],required:!0,validator:(t,e)=>e?!0:new Error("Article category is required")},title:{trigger:["change","blur","input"],required:!0,validator:(t,e)=>e?!0:new Error("Title is required")},content:{trigger:["change","blur","input"],required:!0,validator:(t,e)=>(e?e.replace(/<[^>]*>?/gm,"").trim():"").length>0?!0:new Error("Content is required")}},w=()=>{var t;(t=m.value)==null||t.validate(e=>{e||(n.article?r.post(route("update.articles",{article:n.article.id})):r.post(route("store.articles")))})};return F(()=>{try{c.value=CKEDITOR.replace("content",{removePlugins:"versionCheck",width:"100%",height:300,notification:{duration:0},on:{change:function(){var t;r.content=c.value.getData(),(t=m.value)==null||t.validate()},instanceReady:function(){r.content&&c.value.setData(r.content)}}})}catch(t){console.error("CKEditor initialization failed:",t)}}),U(()=>{if(c.value){try{c.value.destroy()}catch(t){console.error("CKEditor cleanup failed:",t)}c.value=null}}),(t,e)=>{const v=s("n-upload"),d=s("n-form-item"),C=s("n-select"),E=s("n-input"),q=s("n-button"),T=s("n-form"),j=s("n-card");return D(),B(M,null,[a(i(P),{title:"Articles"}),a(N,null,{default:l(()=>[u("div",z,[u("div",O,[e[5]||(e[5]=u("div",{class:"flex items-center justify-between px-4"},[u("h1",{class:"text-2xl font-bold"},"Form Articles")],-1)),a(j,{class:"mt-4"},{default:l(()=>[a(T,{ref_key:"formRef",ref:m,model:i(r),rules:x,onSubmit:R(w,["prevent"])},{default:l(()=>[a(d,{path:"image",label:"Image"},{default:l(()=>[a(v,{"default-upload":!1,max:1,accept:"image/*","list-type":"image-card","file-list":i(r).image?[i(r).image]:[],"onUpdate:fileList":e[0]||(e[0]=o=>i(r).image=o.length?o[0]:null),name:"image"},null,8,["file-list"])]),_:1}),a(d,{path:"article_category_id",label:"Article Category"},{default:l(()=>[a(C,{value:i(r).article_category_id,"onUpdate:value":e[1]||(e[1]=o=>i(r).article_category_id=o),options:h.value},null,8,["value","options"])]),_:1}),a(d,{path:"title",label:"Title"},{default:l(()=>[a(E,{value:i(r).title,"onUpdate:value":e[2]||(e[2]=o=>i(r).title=o),placeholder:"Enter title"},null,8,["value"])]),_:1}),a(d,{path:"content",label:"Content"},{default:l(()=>[V(u("textarea",{"onUpdate:modelValue":e[3]||(e[3]=o=>i(r).content=o),name:"content",id:"content",cols:"30",rows:"10",class:"ckeditor"},null,512),[[I,i(r).content]])]),_:1}),u("div",S,[a(q,{"attr-type":"submit",type:"primary",size:"large",disabled:i(r).processing},{default:l(()=>e[4]||(e[4]=[K(" Submit ")])),_:1},8,["disabled"])])]),_:1},8,["model"])]),_:1})])])]),_:1})],64)}}};export{Q as default};

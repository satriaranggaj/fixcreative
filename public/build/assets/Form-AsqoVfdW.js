import{r as y,C as A,c as D,o as R,a as F,b as c,d as I,e as P,f as a,u as i,m as U,w as s,g as d,h as B,i as K,v as O,j as V,F as M}from"./app-B6c4nCTd.js";import{_ as N}from"./AuthenticatedLayout-D3SlnMZe.js";import"./ApplicationStore-Blr9INut.js";import"./ApplicationLogo-DeqSs-SK.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./UserRegular-BMmSYD_P.js";import"./AppMessageListener-CXKMAt8I.js";const S={class:"py-12"},z={class:"mx-auto max-w-[90%]"},L={class:"flex justify-end"},Y={__name:"Form",props:{article_categories:Array,article:Object},setup(b){var f,g,_,v;const o=b,p=y(null),u=y(null),r=A({image:(f=o.article)!=null&&f.image?{url:"/storage/"+o.article.image,name:o.article.image.split("/").pop(),type:"/image/.*/",status:"finished"}:null,article_category_id:((g=o.article)==null?void 0:g.article_category_id)??null,title:((_=o.article)==null?void 0:_.title)??"",content:((v=o.article)==null?void 0:v.content)??""}),w=D(()=>{var t;return((t=o.article_categories)==null?void 0:t.map(e=>({label:e.name,value:e.id})))||[]}),h={image:{trigger:["input","blur","change"],required:!0,validator(t,e){return e?/image\/.*/.test(e.type)?Promise.resolve():Promise.reject(new Error("File type must be an image")):Promise.reject(new Error("Image is required"))}},article_category_id:{trigger:["change","blur","input"],required:!0,validator:(t,e)=>e?!0:new Error("Article category is required")},title:{trigger:["change","blur","input"],required:!0,validator:(t,e)=>e?!0:new Error("Title is required")},content:{trigger:["change","blur","input"],required:!0,validator:(t,e)=>(e?e.replace(/<[^>]*>?/gm,"").trim():"").length>0?!0:new Error("Content is required")}},x=()=>{var t;(t=p.value)==null||t.validate(e=>{e||(o.article?r.post(route("update.articles",{article:o.article.slug})):r.post(route("store.articles")))})};R(async()=>{window.CKEDITOR||await C("/libraries/ckeditor/ckeditor.js"),window.CKEDITOR&&(u.value=CKEDITOR.replace("content",{removePlugins:"versionCheck",width:"100%",height:300,notification:{duration:0},on:{change:function(){var t;r.content=u.value.getData(),(t=p.value)==null||t.validate()},instanceReady:function(){r.content&&u.value.setData(r.content)}}}))});const C=t=>new Promise((e,m)=>{const n=document.createElement("script");n.src=t,n.async=!0,n.onload=e,n.onerror=m,document.body.appendChild(n)});return F(()=>{if(u.value){try{u.value.destroy()}catch(t){console.error("CKEditor cleanup failed:",t)}u.value=null}}),(t,e)=>{const m=c("n-upload"),n=c("n-form-item"),E=c("n-select"),T=c("n-input"),q=c("n-button"),j=c("n-form"),k=c("n-card");return P(),I(M,null,[a(i(U),{title:"Articles"}),a(N,null,{default:s(()=>[d("div",S,[d("div",z,[e[5]||(e[5]=d("div",{class:"flex items-center justify-between px-4"},[d("h1",{class:"text-2xl font-bold"},"Form Articles")],-1)),a(k,{class:"mt-4"},{default:s(()=>[a(j,{ref_key:"formRef",ref:p,model:i(r),rules:h,onSubmit:B(x,["prevent"])},{default:s(()=>[a(n,{path:"image",label:"Image"},{default:s(()=>[a(m,{"default-upload":!1,max:1,accept:"image/*","list-type":"image-card","file-list":i(r).image?[i(r).image]:[],"onUpdate:fileList":e[0]||(e[0]=l=>i(r).image=l.length?l[0]:null),name:"image"},null,8,["file-list"])]),_:1}),a(n,{path:"article_category_id",label:"Article Category"},{default:s(()=>[a(E,{value:i(r).article_category_id,"onUpdate:value":e[1]||(e[1]=l=>i(r).article_category_id=l),options:w.value},null,8,["value","options"])]),_:1}),a(n,{path:"title",label:"Title"},{default:s(()=>[a(T,{value:i(r).title,"onUpdate:value":e[2]||(e[2]=l=>i(r).title=l),placeholder:"Enter title"},null,8,["value"])]),_:1}),a(n,{path:"content",label:"Content"},{default:s(()=>[K(d("textarea",{"onUpdate:modelValue":e[3]||(e[3]=l=>i(r).content=l),name:"content",id:"content",cols:"30",rows:"10",class:"ckeditor"},null,512),[[O,i(r).content]])]),_:1}),d("div",L,[a(q,{"attr-type":"submit",type:"primary",size:"large",disabled:i(r).processing},{default:s(()=>e[4]||(e[4]=[V(" Submit ")])),_:1},8,["disabled"])])]),_:1},8,["model"])]),_:1})])])]),_:1})],64)}}};export{Y as default};

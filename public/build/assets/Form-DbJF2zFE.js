import{r as b,C as j,c as k,o as U,a as B,b as s,d as D,e as F,f as r,u as i,m as M,w as l,g as p,h as R,i as V,v as K,j as N,F as S}from"./app-Li_GEc12.js";import{_ as z}from"./AuthenticatedLayout-DwIPfsDe.js";import"./ApplicationStore-DTd44c_R.js";import"./AppMessageListener-C2XSfOzH.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const I={class:"py-12"},O={class:"mx-auto max-w-[90%]"},A={class:"flex justify-end"},Q={__name:"Form",props:{portfolio_categories:Array,portfolio:Object},setup(y){var m,_,g,v;const n=y,c=b(null),u=b(null),o=j({image:(m=n.portfolio)!=null&&m.image?n.portfolio.image.map(t=>({url:"/storage/"+t,name:t.split("/").pop(),type:"image/*",status:"finished"})):[],portfolio_category_id:((_=n.portfolio)==null?void 0:_.portfolio_category_id)??null,title:((g=n.portfolio)==null?void 0:g.title)??"",content:((v=n.portfolio)==null?void 0:v.content)??""}),h=k(()=>{var t;return((t=n.portfolio_categories)==null?void 0:t.map(e=>({label:e.name,value:e.id})))||[]}),x={image:{trigger:["input","blur","change"],required:!0,validator(t,e){if(!e||e.length===0)return Promise.reject(new Error("Minimal 1 gambar harus dipilih"));for(const d of e)if(!/image\/.*/.test(d.type))return Promise.reject(new Error("Semua file harus bertipe gambar"));return Promise.resolve()}},portfolio_category_id:{trigger:["change","blur","input"],required:!0,validator:(t,e)=>e?!0:new Error("Portfolio category is required")},title:{trigger:["change","blur","input"],required:!0,validator:(t,e)=>e?!0:new Error("Title is required")},content:{trigger:["change","blur","input"],required:!0,validator:(t,e)=>(e?e.replace(/<[^>]*>?/gm,"").trim():"").length>0?!0:new Error("Content is required")}},w=()=>{var t;(t=c.value)==null||t.validate(e=>{e||(n.portfolio?o.post(route("update.portfolios",{portfolio:n.portfolio.id})):o.post(route("store.portfolios")))})};return U(()=>{try{u.value=CKEDITOR.replace("content",{removePlugins:"versionCheck",width:"100%",height:300,notification:{duration:0},on:{change:function(){var t;o.content=u.value.getData(),(t=c.value)==null||t.validate()},instanceReady:function(){o.content&&u.value.setData(o.content)}}})}catch(t){console.error("CKEditor initialization failed:",t)}}),B(()=>{if(u.value){try{u.value.destroy()}catch(t){console.error("CKEditor cleanup failed:",t)}u.value=null}}),(t,e)=>{const d=s("n-upload"),f=s("n-form-item"),C=s("n-select"),E=s("n-input"),q=s("n-button"),P=s("n-form"),T=s("n-card");return F(),D(S,null,[r(i(M),{title:"portfolios"}),r(z,null,{default:l(()=>[p("div",I,[p("div",O,[e[5]||(e[5]=p("div",{class:"flex items-center justify-between px-4"},[p("h1",{class:"text-2xl font-bold"},"Form Portfolio")],-1)),r(T,{class:"mt-4"},{default:l(()=>[r(P,{ref_key:"formRef",ref:c,model:i(o),rules:x,onSubmit:R(w,["prevent"])},{default:l(()=>[r(f,{path:"image",label:"Image"},{default:l(()=>[r(d,{"default-upload":!1,accept:"image/*","list-type":"image-card",multiple:"","file-list":i(o).image,"onUpdate:fileList":e[0]||(e[0]=a=>i(o).image=a),name:"image"},null,8,["file-list"])]),_:1}),r(f,{path:"portfolio_category_id",label:"Portfolio Category"},{default:l(()=>[r(C,{value:i(o).portfolio_category_id,"onUpdate:value":e[1]||(e[1]=a=>i(o).portfolio_category_id=a),options:h.value},null,8,["value","options"])]),_:1}),r(f,{path:"title",label:"Title"},{default:l(()=>[r(E,{value:i(o).title,"onUpdate:value":e[2]||(e[2]=a=>i(o).title=a),placeholder:"Enter title"},null,8,["value"])]),_:1}),r(f,{path:"content",label:"Content"},{default:l(()=>[V(p("textarea",{"onUpdate:modelValue":e[3]||(e[3]=a=>i(o).content=a),name:"content",id:"content",cols:"30",rows:"10",class:"ckeditor"},null,512),[[K,i(o).content]])]),_:1}),p("div",A,[r(q,{"attr-type":"submit",type:"primary",size:"large",disabled:i(o).processing},{default:l(()=>e[4]||(e[4]=[N(" Submit ")])),_:1},8,["disabled"])])]),_:1},8,["model"])]),_:1})])])]),_:1})],64)}}};export{Q as default};

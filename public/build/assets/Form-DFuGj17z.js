import{r as y,C as q,c as D,o as R,a as U,b as p,d as B,e as F,f as r,u as i,m as K,w as u,g as c,h as M,i as N,v as S,j as V,F as I}from"./app-DriBaRtj.js";import{_ as O}from"./AuthenticatedLayout-GW3MS-cN.js";import"./ApplicationStore-COy2iVOq.js";import"./AppMessageListener-DBpNqtbR.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"py-12"},A={class:"mx-auto max-w-[90%]"},L={class:"flex justify-end"},W={__name:"Form",props:{portfolio_categories:Array,portfolio:Object},setup(b){var f,_,g,v;const a=b,m=y(null),l=y(null),o=q({image:(f=a.portfolio)!=null&&f.image?a.portfolio.image.map(t=>({url:"/storage/"+t,name:t.split("/").pop(),type:"image/*",status:"finished"})):[],portfolio_category_id:((_=a.portfolio)==null?void 0:_.portfolio_category_id)??null,title:((g=a.portfolio)==null?void 0:g.title)??"",content:((v=a.portfolio)==null?void 0:v.content)??""}),h=D(()=>{var t;return((t=a.portfolio_categories)==null?void 0:t.map(e=>({label:e.name,value:e.id})))||[]}),w={image:{trigger:["input","blur","change"],required:!0,validator(t,e){if(!e||e.length===0)return Promise.reject(new Error("Minimal 1 gambar harus dipilih"));for(const s of e)if(!/image\/.*/.test(s.type))return Promise.reject(new Error("Semua file harus bertipe gambar"));return Promise.resolve()}},portfolio_category_id:{required:!0,validator:(t,e)=>e?!0:new Error("Portfolio category is required")},title:{required:!0,validator:(t,e)=>e?!0:new Error("Title is required")},content:{required:!0,validator:(t,e)=>(e?e.replace(/<[^>]*>?/gm,"").trim():"").length>0?!0:new Error("Content is required")}},x=()=>{var t;(t=m.value)==null||t.validate(e=>{if(e)return;const s=a.portfolio?route("update.portfolios",{portfolio:a.portfolio.slug}):route("store.portfolios");o.post(s)})},C=t=>new Promise((e,s)=>{if(window.CKEDITOR)return e();const n=document.createElement("script");n.src=t,n.async=!0,n.onload=e,n.onerror=s,document.body.appendChild(n)});return R(async()=>{await C("/libraries/ckeditor/ckeditor.js");try{l.value=CKEDITOR.replace("content",{removePlugins:"versionCheck",width:"100%",height:300,notification:{duration:0}}),l.value.on("change",()=>{var t;o.content=l.value.getData(),(t=m.value)==null||t.validate()}),l.value.on("instanceReady",()=>{o.content&&l.value.setData(o.content)})}catch(t){console.error("CKEditor initialization failed:",t)}}),U(()=>{if(l.value){try{l.value.destroy()}catch(t){console.error("CKEditor cleanup failed:",t)}l.value=null}}),(t,e)=>{const s=p("n-upload"),n=p("n-form-item"),E=p("n-select"),P=p("n-input"),T=p("n-button"),j=p("n-form"),k=p("n-card");return F(),B(I,null,[r(i(K),{title:"portfolios"}),r(O,null,{default:u(()=>[c("div",z,[c("div",A,[e[5]||(e[5]=c("div",{class:"flex items-center justify-between px-4"},[c("h1",{class:"text-2xl font-bold"},"Form Portfolio")],-1)),r(k,{class:"mt-4"},{default:u(()=>[r(j,{ref_key:"formRef",ref:m,model:i(o),rules:w,onSubmit:M(x,["prevent"])},{default:u(()=>[r(n,{path:"image",label:"Image"},{default:u(()=>[r(s,{"default-upload":!1,accept:"image/*","list-type":"image-card",multiple:"","file-list":i(o).image,"onUpdate:fileList":e[0]||(e[0]=d=>i(o).image=d),name:"image"},null,8,["file-list"])]),_:1}),r(n,{path:"portfolio_category_id",label:"Portfolio Category"},{default:u(()=>[r(E,{value:i(o).portfolio_category_id,"onUpdate:value":e[1]||(e[1]=d=>i(o).portfolio_category_id=d),options:h.value},null,8,["value","options"])]),_:1}),r(n,{path:"title",label:"Title"},{default:u(()=>[r(P,{value:i(o).title,"onUpdate:value":e[2]||(e[2]=d=>i(o).title=d),placeholder:"Enter title"},null,8,["value"])]),_:1}),r(n,{path:"content",label:"Content"},{default:u(()=>[N(c("textarea",{"onUpdate:modelValue":e[3]||(e[3]=d=>i(o).content=d),name:"content",id:"content",cols:"30",rows:"10",class:"ckeditor"},null,512),[[S,i(o).content]])]),_:1}),c("div",L,[r(T,{"attr-type":"submit",type:"primary",size:"large",disabled:i(o).processing},{default:u(()=>e[4]||(e[4]=[V(" Submit ")])),_:1},8,["disabled"])])]),_:1},8,["model"])]),_:1})])])]),_:1})],64)}}};export{W as default};
